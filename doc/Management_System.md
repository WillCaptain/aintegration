# ç®¡ç†ç³»ç»Ÿè®¾è®¡

**ç‰ˆæœ¬**: v1.0  
**æ—¥æœŸ**: 2025-10-15  
**ç‰¹æ€§**: BL-014.4 - ç®¡ç†ç³»ç»Ÿ

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

### æ ¸å¿ƒéœ€æ±‚
æä¾›å®Œæ•´çš„ä¼ä¸šçº§ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç”¨æˆ·ä¸è§’è‰²ç®¡ç†ã€åº”ç”¨é…ç½®ç®¡ç†ã€A2Aç®¡ç†ã€MCPé…ç½®ç®¡ç†ç­‰ï¼Œæ”¯æŒå¤šç§Ÿæˆ·ã€æƒé™æ§åˆ¶ã€ç›‘æ§å®¡è®¡ç­‰åŠŸèƒ½ã€‚

### ç®¡ç†æ¨¡å—
1. **ç”¨æˆ·ä¸è§’è‰²ç®¡ç†**: ç”¨æˆ·åˆ›å»ºã€è§’è‰²åˆ†é…ã€æƒé™æ§åˆ¶
2. **åº”ç”¨é…ç½®ç®¡ç†**: HRã€ITã€è´¢åŠ¡ç­‰åº”ç”¨çš„é…ç½®ç®¡ç†
3. **A2Aç®¡ç†**: Agentæ³¨å†Œã€å‘ç°ã€å¥åº·æ£€æŸ¥
4. **MCPé…ç½®ç®¡ç†**: å·¥å…·æ³¨å†Œã€åˆ†ç±»ã€SchemaéªŒè¯
5. **å·¥ä½œæµç®¡ç†**: æµç¨‹å®šä¹‰ã€ç›‘æ§ã€å®¡è®¡æ—¥å¿—
6. **ç›‘æ§é¢æ¿**: ç³»ç»ŸçŠ¶æ€ã€æ€§èƒ½æŒ‡æ ‡ã€é”™è¯¯ç›‘æ§

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### ç®¡ç†åå°æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AIntegration ç®¡ç†åå°                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ç”¨æˆ·ç®¡ç†     â”‚ â”‚ è§’è‰²æƒé™     â”‚ â”‚ ç»„ç»‡æ¶æ„     â”‚       â”‚
â”‚  â”‚ User Mgmt   â”‚ â”‚ Role & Auth â”‚ â”‚ Org Chart   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ åº”ç”¨é…ç½®     â”‚ â”‚ A2Aç®¡ç†     â”‚ â”‚ MCPé…ç½®     â”‚       â”‚
â”‚  â”‚ App Config  â”‚ â”‚ A2A Mgmt    â”‚ â”‚ MCP Config  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ å·¥ä½œæµç®¡ç†   â”‚ â”‚ ç›‘æ§é¢æ¿     â”‚ â”‚ æ—¥å¿—å®¡è®¡     â”‚       â”‚
â”‚  â”‚ Workflow    â”‚ â”‚ Monitoring  â”‚ â”‚ Audit Log   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æƒé™æ¨¡å‹
```
ç”¨æˆ·(User) â†â†’ è§’è‰²(Role) â†â†’ æƒé™(Permission) â†â†’ èµ„æº(Resource)
```

---

## ğŸ’» è¯¦ç»†å®ç°

### 1. ç”¨æˆ·ä¸è§’è‰²ç®¡ç†

#### æ•°æ®æ¨¡å‹
```python
@dataclass
class User:
    """ç”¨æˆ·æ¨¡å‹"""
    id: str
    username: str
    email: str
    full_name: str
    department: str
    position: str
    roles: List[str]
    permissions: List[str]
    is_active: bool
    created_at: datetime
    last_login: Optional[datetime]
    tenant_id: str  # å¤šç§Ÿæˆ·æ”¯æŒ
    metadata: Dict[str, Any]

@dataclass
class Role:
    """è§’è‰²æ¨¡å‹"""
    id: str
    name: str
    description: str
    permissions: List[str]
    department: str
    level: int  # 1-10, æ•°å­—è¶Šå¤§æƒé™è¶Šé«˜
    tenant_id: str
    is_system_role: bool  # æ˜¯å¦ä¸ºç³»ç»Ÿè§’è‰²
    created_at: datetime
    updated_at: datetime

@dataclass
class Permission:
    """æƒé™æ¨¡å‹"""
    id: str
    name: str
    description: str
    resource: str  # èµ„æºç±»å‹
    action: str    # æ“ä½œç±»å‹
    conditions: Dict[str, Any]  # æƒé™æ¡ä»¶

@dataclass
class Tenant:
    """ç§Ÿæˆ·æ¨¡å‹"""
    id: str
    name: str
    domain: str
    settings: Dict[str, Any]
    is_active: bool
    created_at: datetime
    subscription_plan: str
```

#### ç”¨æˆ·è§’è‰²ç®¡ç†å™¨
```python
class UserRoleManager:
    """ç”¨æˆ·è§’è‰²ç®¡ç†å™¨"""
    
    def __init__(self, user_repo, role_repo, permission_repo, tenant_repo):
        self.user_repo = user_repo
        self.role_repo = role_repo
        self.permission_repo = permission_repo
        self.tenant_repo = tenant_repo
    
    async def create_user(self, user_data: Dict[str, Any]) -> User:
        """åˆ›å»ºç”¨æˆ·"""
        user = User(
            id=generate_id(),
            username=user_data['username'],
            email=user_data['email'],
            full_name=user_data['full_name'],
            department=user_data['department'],
            position=user_data['position'],
            roles=user_data.get('roles', []),
            permissions=[],
            is_active=True,
            created_at=datetime.now(),
            tenant_id=user_data.get('tenant_id', 'default'),
            metadata=user_data.get('metadata', {})
        )
        
        # æ ¹æ®è§’è‰²è®¡ç®—æƒé™
        user.permissions = await self._calculate_permissions(user.roles, user.tenant_id)
        
        await self.user_repo.create(user)
        return user
    
    async def assign_role(self, user_id: str, role_id: str) -> bool:
        """åˆ†é…è§’è‰²"""
        user = await self.user_repo.get_by_id(user_id)
        role = await self.role_repo.get_by_id(role_id)
        
        if not user or not role:
            return False
        
        if role_id not in user.roles:
            user.roles.append(role_id)
            user.permissions = await self._calculate_permissions(user.roles, user.tenant_id)
            await self.user_repo.update(user_id, {
                "roles": user.roles, 
                "permissions": user.permissions
            })
            return True
        return False
    
    async def remove_role(self, user_id: str, role_id: str) -> bool:
        """ç§»é™¤è§’è‰²"""
        user = await self.user_repo.get_by_id(user_id)
        if not user:
            return False
        
        if role_id in user.roles:
            user.roles.remove(role_id)
            user.permissions = await self._calculate_permissions(user.roles, user.tenant_id)
            await self.user_repo.update(user_id, {
                "roles": user.roles,
                "permissions": user.permissions
            })
            return True
        return False
    
    async def _calculate_permissions(self, role_ids: List[str], tenant_id: str) -> List[str]:
        """æ ¹æ®è§’è‰²è®¡ç®—æƒé™"""
        permissions = set()
        
        for role_id in role_ids:
            role = await self.role_repo.get_by_id(role_id)
            if role and role.tenant_id == tenant_id:
                permissions.update(role.permissions)
        
        return list(permissions)
    
    async def check_permission(self, user_id: str, resource: str, action: str) -> bool:
        """æ£€æŸ¥ç”¨æˆ·æƒé™"""
        user = await self.user_repo.get_by_id(user_id)
        if not user:
            return False
        
        # æ£€æŸ¥ç›´æ¥æƒé™
        for permission in user.permissions:
            perm = await self.permission_repo.get_by_id(permission)
            if perm and perm.resource == resource and perm.action == action:
                return True
        
        return False
```

### 2. åº”ç”¨é…ç½®ç®¡ç†

#### æ•°æ®æ¨¡å‹
```python
@dataclass
class AppConfig:
    """åº”ç”¨é…ç½®æ¨¡å‹"""
    id: str
    name: str
    type: str  # 'hr', 'it', 'finance', 'custom'
    config: Dict[str, Any]
    is_active: bool
    tenant_id: str
    created_at: datetime
    updated_at: datetime
    version: str
    dependencies: List[str]

@dataclass
class AppTemplate:
    """åº”ç”¨æ¨¡æ¿æ¨¡å‹"""
    id: str
    name: str
    description: str
    type: str
    template_config: Dict[str, Any]
    required_permissions: List[str]
    is_public: bool
```

#### åº”ç”¨é…ç½®ç®¡ç†å™¨
```python
class AppConfigManager:
    """åº”ç”¨é…ç½®ç®¡ç†å™¨"""
    
    def __init__(self, config_repo, template_repo, tenant_repo):
        self.config_repo = config_repo
        self.template_repo = template_repo
        self.tenant_repo = tenant_repo
    
    async def create_app_config(self, config_data: Dict[str, Any]) -> AppConfig:
        """åˆ›å»ºåº”ç”¨é…ç½®"""
        app_config = AppConfig(
            id=generate_id(),
            name=config_data['name'],
            type=config_data['type'],
            config=config_data['config'],
            is_active=True,
            tenant_id=config_data['tenant_id'],
            created_at=datetime.now(),
            updated_at=datetime.now(),
            version=config_data.get('version', '1.0.0'),
            dependencies=config_data.get('dependencies', [])
        )
        
        await self.config_repo.create(app_config)
        
        # é€šçŸ¥ç›¸å…³Agentæ›´æ–°é…ç½®
        await self._notify_agents_config_update(app_config)
        
        return app_config
    
    async def update_app_config(self, config_id: str, updates: Dict[str, Any]) -> bool:
        """æ›´æ–°åº”ç”¨é…ç½®"""
        app_config = await self.config_repo.get_by_id(config_id)
        if not app_config:
            return False
        
        # æ›´æ–°é…ç½®
        app_config.config.update(updates.get('config', {}))
        app_config.updated_at = datetime.now()
        app_config.version = self._increment_version(app_config.version)
        
        await self.config_repo.update(config_id, {
            "config": app_config.config,
            "updated_at": app_config.updated_at,
            "version": app_config.version
        })
        
        # é€šçŸ¥Agenté…ç½®æ›´æ–°
        await self._notify_agents_config_update(app_config)
        
        return True
    
    async def _notify_agents_config_update(self, app_config: AppConfig):
        """é€šçŸ¥Agenté…ç½®æ›´æ–°"""
        # é€šè¿‡A2Aé€šçŸ¥ç›¸å…³Agent
        notification = {
            "type": "config_update",
            "app_id": app_config.id,
            "app_type": app_config.type,
            "config": app_config.config,
            "version": app_config.version
        }
        
        # è¿™é‡Œåº”è¯¥è°ƒç”¨A2Aå¹¿æ’­
        # await self.a2a_client.broadcast_to_agents(notification)
    
    def _increment_version(self, current_version: str) -> str:
        """é€’å¢ç‰ˆæœ¬å·"""
        parts = current_version.split('.')
        if len(parts) == 3:
            patch = int(parts[2]) + 1
            return f"{parts[0]}.{parts[1]}.{patch}"
        return "1.0.1"
```

### 3. A2Aç®¡ç†

#### æ•°æ®æ¨¡å‹
```python
@dataclass
class A2AAgent:
    """A2A Agentæ¨¡å‹"""
    id: str
    name: str
    type: str
    endpoint: str
    capabilities: List[str]
    status: str  # 'online', 'offline', 'error'
    last_heartbeat: datetime
    metadata: Dict[str, Any]
    tenant_id: str
    health_score: float  # å¥åº·åˆ†æ•° 0-1

@dataclass
class A2AMethod:
    """A2Aæ–¹æ³•æ¨¡å‹"""
    id: str
    agent_id: str
    name: str
    description: str
    parameters: Dict[str, Any]
    return_type: str
    is_async: bool
```

#### A2Aç®¡ç†å™¨
```python
class A2AManager:
    """A2Aç®¡ç†å™¨"""
    
    def __init__(self, agent_repo, method_repo):
        self.agent_repo = agent_repo
        self.method_repo = method_repo
        self.health_monitor = HealthMonitor()
    
    async def register_agent(self, agent_data: Dict[str, Any]) -> A2AAgent:
        """æ³¨å†ŒAgent"""
        agent = A2AAgent(
            id=generate_id(),
            name=agent_data['name'],
            type=agent_data['type'],
            endpoint=agent_data['endpoint'],
            capabilities=agent_data['capabilities'],
            status='offline',
            last_heartbeat=datetime.now(),
            metadata=agent_data.get('metadata', {}),
            tenant_id=agent_data.get('tenant_id', 'default'),
            health_score=1.0
        )
        
        await self.agent_repo.create(agent)
        
        # æ³¨å†ŒAgentæ–¹æ³•
        if 'methods' in agent_data:
            await self._register_agent_methods(agent.id, agent_data['methods'])
        
        # å¯åŠ¨å¥åº·ç›‘æ§
        await self.health_monitor.start_monitoring(agent.id)
        
        return agent
    
    async def discover_agents(self, capability: str = None, tenant_id: str = None) -> List[A2AAgent]:
        """å‘ç°Agent"""
        if capability and tenant_id:
            return await self.agent_repo.find_by_capability_and_tenant(capability, tenant_id)
        elif capability:
            return await self.agent_repo.find_by_capability(capability)
        elif tenant_id:
            return await self.agent_repo.find_by_tenant(tenant_id)
        else:
            return await self.agent_repo.find_all_active()
    
    async def health_check(self) -> Dict[str, Any]:
        """å¥åº·æ£€æŸ¥"""
        agents = await self.agent_repo.find_all()
        health_status = {
            "total_agents": len(agents),
            "online_agents": len([a for a in agents if a.status == 'online']),
            "offline_agents": len([a for a in agents if a.status == 'offline']),
            "error_agents": len([a for a in agents if a.status == 'error']),
            "average_health_score": sum(a.health_score for a in agents) / len(agents) if agents else 0
        }
        return health_status
    
    async def _register_agent_methods(self, agent_id: str, methods: List[Dict[str, Any]]):
        """æ³¨å†ŒAgentæ–¹æ³•"""
        for method_data in methods:
            method = A2AMethod(
                id=generate_id(),
                agent_id=agent_id,
                name=method_data['name'],
                description=method_data.get('description', ''),
                parameters=method_data.get('parameters', {}),
                return_type=method_data.get('return_type', 'any'),
                is_async=method_data.get('is_async', True)
            )
            await self.method_repo.create(method)
```

### 4. MCPé…ç½®ç®¡ç†

#### æ•°æ®æ¨¡å‹
```python
@dataclass
class MCPTool:
    """MCPå·¥å…·æ¨¡å‹"""
    id: str
    name: str
    description: str
    category: str
    schema: Dict[str, Any]
    is_active: bool
    created_at: datetime
    updated_at: datetime
    tenant_id: str
    version: str
    usage_count: int

@dataclass
class MCPCategory:
    """MCPåˆ†ç±»æ¨¡å‹"""
    id: str
    name: str
    description: str
    parent_id: Optional[str]
    sort_order: int
```

#### MCPç®¡ç†å™¨
```python
class MCPManager:
    """MCPç®¡ç†å™¨"""
    
    def __init__(self, tool_repo, category_repo):
        self.tool_repo = tool_repo
        self.category_repo = category_repo
    
    async def register_tool(self, tool_data: Dict[str, Any]) -> MCPTool:
        """æ³¨å†ŒMCPå·¥å…·"""
        tool = MCPTool(
            id=generate_id(),
            name=tool_data['name'],
            description=tool_data['description'],
            category=tool_data['category'],
            schema=tool_data['schema'],
            is_active=True,
            created_at=datetime.now(),
            updated_at=datetime.now(),
            tenant_id=tool_data.get('tenant_id', 'default'),
            version=tool_data.get('version', '1.0.0'),
            usage_count=0
        )
        
        await self.tool_repo.create(tool)
        
        # é€šçŸ¥MCPæœåŠ¡å™¨æ›´æ–°å·¥å…·åˆ—è¡¨
        await self._notify_mcp_server(tool)
        
        return tool
    
    async def get_tools_by_category(self, category: str, tenant_id: str = None) -> List[MCPTool]:
        """æ ¹æ®åˆ†ç±»è·å–å·¥å…·"""
        if tenant_id:
            return await self.tool_repo.find_by_category_and_tenant(category, tenant_id)
        return await self.tool_repo.find_by_category(category)
    
    async def validate_tool_schema(self, schema: Dict[str, Any]) -> Dict[str, Any]:
        """éªŒè¯å·¥å…·Schema"""
        required_fields = ['name', 'parameters', 'returns']
        validation_result = {
            "is_valid": True,
            "errors": [],
            "warnings": []
        }
        
        # æ£€æŸ¥å¿…éœ€å­—æ®µ
        for field in required_fields:
            if field not in schema:
                validation_result["errors"].append(f"Missing required field: {field}")
                validation_result["is_valid"] = False
        
        # éªŒè¯å‚æ•°å®šä¹‰
        if 'parameters' in schema:
            params = schema['parameters']
            if not isinstance(params, dict):
                validation_result["errors"].append("Parameters must be a dictionary")
                validation_result["is_valid"] = False
        
        # æ£€æŸ¥å‘½åè§„èŒƒ
        if 'name' in schema:
            name = schema['name']
            if not re.match(r'^[a-zA-Z_][a-zA-Z0-9_]*$', name):
                validation_result["warnings"].append("Tool name should follow naming conventions")
        
        return validation_result
    
    async def _notify_mcp_server(self, tool: MCPTool):
        """é€šçŸ¥MCPæœåŠ¡å™¨"""
        # è¿™é‡Œåº”è¯¥è°ƒç”¨MCPæœåŠ¡å™¨çš„æ³¨å†Œæ¥å£
        # await self.mcp_client.register_tool(tool)
        pass
```

---

## ğŸ¨ ç®¡ç†åå°ç•Œé¢

### ä¸»è¦é¡µé¢è®¾è®¡
```javascript
// ç®¡ç†åå°ä¸»è¦ç»„ä»¶
class AdminDashboard {
    constructor() {
        this.currentModule = 'dashboard';
        this.modules = {
            'dashboard': new DashboardModule(),
            'users': new UserManagementModule(),
            'roles': new RoleManagementModule(),
            'apps': new AppConfigModule(),
            'a2a': new A2AManagementModule(),
            'mcp': new MCPManagementModule(),
            'workflows': new WorkflowManagementModule(),
            'monitoring': new MonitoringModule(),
            'audit': new AuditLogModule()
        };
    }
    
    render() {
        return `
            <div class="admin-layout">
                <header class="admin-header">
                    <div class="header-left">
                        <h1>AIntegration ç®¡ç†åå°</h1>
                    </div>
                    <div class="header-right">
                        <span class="tenant-info">ç§Ÿæˆ·: ${this.currentTenant}</span>
                        <span class="user-info">ç”¨æˆ·: ${this.currentUser}</span>
                        <button onclick="logout()">é€€å‡º</button>
                    </div>
                </header>
                
                <div class="admin-content">
                    <nav class="admin-sidebar">
                        ${this.renderSidebar()}
                    </nav>
                    
                    <main class="admin-main">
                        ${this.modules[this.currentModule].render()}
                    </main>
                </div>
            </div>
        `;
    }
    
    renderSidebar() {
        const menuItems = [
            { id: 'dashboard', label: 'ä»ªè¡¨æ¿', icon: 'ğŸ“Š' },
            { id: 'users', label: 'ç”¨æˆ·ç®¡ç†', icon: 'ğŸ‘¥' },
            { id: 'roles', label: 'è§’è‰²æƒé™', icon: 'ğŸ”' },
            { id: 'apps', label: 'åº”ç”¨é…ç½®', icon: 'âš™ï¸' },
            { id: 'a2a', label: 'A2Aç®¡ç†', icon: 'ğŸ¤–' },
            { id: 'mcp', label: 'MCPé…ç½®', icon: 'ğŸ”§' },
            { id: 'workflows', label: 'å·¥ä½œæµ', icon: 'ğŸ”„' },
            { id: 'monitoring', label: 'ç›‘æ§é¢æ¿', icon: 'ğŸ“ˆ' },
            { id: 'audit', label: 'å®¡è®¡æ—¥å¿—', icon: 'ğŸ“' }
        ];
        
        return `
            <ul class="sidebar-menu">
                ${menuItems.map(item => `
                    <li class="menu-item ${this.currentModule === item.id ? 'active' : ''}"
                        onclick="switchModule('${item.id}')">
                        <span class="menu-icon">${item.icon}</span>
                        <span class="menu-label">${item.label}</span>
                    </li>
                `).join('')}
            </ul>
        `;
    }
}

// ç”¨æˆ·ç®¡ç†æ¨¡å—
class UserManagementModule {
    async render() {
        const users = await this.fetchUsers();
        return `
            <div class="user-management">
                <div class="page-header">
                    <h2>ç”¨æˆ·ç®¡ç†</h2>
                    <button onclick="showCreateUserDialog()" class="btn-primary">åˆ›å»ºç”¨æˆ·</button>
                </div>
                
                <div class="user-table">
                    <table>
                        <thead>
                            <tr>
                                <th>ç”¨æˆ·å</th>
                                <th>å§“å</th>
                                <th>é‚®ç®±</th>
                                <th>éƒ¨é—¨</th>
                                <th>è§’è‰²</th>
                                <th>çŠ¶æ€</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${users.map(user => `
                                <tr>
                                    <td>${user.username}</td>
                                    <td>${user.full_name}</td>
                                    <td>${user.email}</td>
                                    <td>${user.department}</td>
                                    <td>${user.roles.join(', ')}</td>
                                    <td>
                                        <span class="status-badge ${user.is_active ? 'active' : 'inactive'}">
                                            ${user.is_active ? 'æ´»è·ƒ' : 'ç¦ç”¨'}
                                        </span>
                                    </td>
                                    <td>
                                        <button onclick="editUser('${user.id}')">ç¼–è¾‘</button>
                                        <button onclick="assignRoles('${user.id}')">åˆ†é…è§’è‰²</button>
                                        <button onclick="toggleUserStatus('${user.id}')">
                                            ${user.is_active ? 'ç¦ç”¨' : 'å¯ç”¨'}
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>
        `;
    }
}
```

---

## ğŸ“Š APIè®¾è®¡

### ç®¡ç†API
```python
# ç”¨æˆ·ç®¡ç†API
@router.get("/admin/users")
async def get_users(
    page: int = 1,
    size: int = 20,
    department: str = None,
    role: str = None,
    user_manager = Depends(get_user_manager)
):
    """è·å–ç”¨æˆ·åˆ—è¡¨"""
    users = await user_manager.get_users(
        page=page, 
        size=size, 
        department=department, 
        role=role
    )
    return users

@router.post("/admin/users")
async def create_user(
    user_data: CreateUserRequest,
    user_manager = Depends(get_user_manager)
):
    """åˆ›å»ºç”¨æˆ·"""
    user = await user_manager.create_user(user_data.dict())
    return {"success": True, "user": user}

@router.post("/admin/users/{user_id}/roles")
async def assign_role(
    user_id: str,
    role_id: str,
    user_manager = Depends(get_user_manager)
):
    """åˆ†é…è§’è‰²"""
    success = await user_manager.assign_role(user_id, role_id)
    return {"success": success}

# A2Aç®¡ç†API
@router.get("/admin/a2a/agents")
async def get_agents(
    status: str = None,
    capability: str = None,
    a2a_manager = Depends(get_a2a_manager)
):
    """è·å–A2A Agentåˆ—è¡¨"""
    agents = await a2a_manager.discover_agents(capability)
    if status:
        agents = [a for a in agents if a.status == status]
    return agents

@router.post("/admin/a2a/agents")
async def register_agent(
    agent_data: RegisterAgentRequest,
    a2a_manager = Depends(get_a2a_manager)
):
    """æ³¨å†ŒA2A Agent"""
    agent = await a2a_manager.register_agent(agent_data.dict())
    return {"success": True, "agent": agent}

# MCPç®¡ç†API
@router.get("/admin/mcp/tools")
async def get_mcp_tools(
    category: str = None,
    mcp_manager = Depends(get_mcp_manager)
):
    """è·å–MCPå·¥å…·åˆ—è¡¨"""
    if category:
        tools = await mcp_manager.get_tools_by_category(category)
    else:
        tools = await mcp_manager.get_all_tools()
    return tools

@router.post("/admin/mcp/tools")
async def register_tool(
    tool_data: RegisterToolRequest,
    mcp_manager = Depends(get_mcp_manager)
):
    """æ³¨å†ŒMCPå·¥å…·"""
    tool = await mcp_manager.register_tool(tool_data.dict())
    return {"success": True, "tool": tool}
```

---

## ğŸ“ˆ å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€ç®¡ç†åŠŸèƒ½ï¼ˆ3å‘¨ï¼‰
- [ ] ç”¨æˆ·ä¸è§’è‰²ç®¡ç†
- [ ] æƒé™æ§åˆ¶ç³»ç»Ÿ
- [ ] åŸºç¡€ç®¡ç†API
- [ ] ç®¡ç†åå°ç•Œé¢

### Phase 2: é…ç½®ç®¡ç†ï¼ˆ2å‘¨ï¼‰
- [ ] åº”ç”¨é…ç½®ç®¡ç†
- [ ] A2Aç®¡ç†
- [ ] MCPé…ç½®ç®¡ç†
- [ ] é…ç½®åŒæ­¥æœºåˆ¶

### Phase 3: ç›‘æ§ä¸å®¡è®¡ï¼ˆ2å‘¨ï¼‰
- [ ] ç›‘æ§é¢æ¿
- [ ] å®¡è®¡æ—¥å¿—
- [ ] æ€§èƒ½æŒ‡æ ‡
- [ ] å‘Šè­¦ç³»ç»Ÿ

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

1. **åŠŸèƒ½å®Œæ•´æ€§**:
   - âœ… ç”¨æˆ·ä¸è§’è‰²ç®¡ç†åŠŸèƒ½å®Œæ•´
   - âœ… æƒé™æ§åˆ¶å‡†ç¡®æœ‰æ•ˆ
   - âœ… é…ç½®ç®¡ç†çµæ´»å¯é 
   - âœ… ç›‘æ§å®¡è®¡åŠŸèƒ½å®Œå–„

2. **å®‰å…¨æ€§**:
   - âœ… å¤šç§Ÿæˆ·éš”ç¦»å®‰å…¨
   - âœ… æƒé™æ§åˆ¶ä¸¥æ ¼
   - âœ… å®¡è®¡æ—¥å¿—å®Œæ•´
   - âœ… æ•°æ®åŠ å¯†å­˜å‚¨

3. **æ€§èƒ½è¦æ±‚**:
   - âœ… ç®¡ç†æ“ä½œå“åº”æ—¶é—´ < 1ç§’
   - âœ… æ”¯æŒ1000+ç”¨æˆ·ç®¡ç†
   - âœ… é…ç½®æ›´æ–°å®æ—¶ç”Ÿæ•ˆ

---

**ç®¡ç†ç³»ç»Ÿå°†ä¸ºAIntegrationæä¾›ä¼ä¸šçº§çš„ç®¡ç†èƒ½åŠ›ï¼Œç¡®ä¿ç³»ç»Ÿçš„å®‰å…¨ã€å¯é å’Œé«˜æ•ˆè¿è¡Œï¼**
